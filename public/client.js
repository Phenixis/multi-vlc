// Generated by CoffeeScript 1.6.2
(function() {
  var runCmd;

  runCmd = function(cmd) {
    var instanceIds, req;

    // Get all checked checkboxes and collect their values
    instanceIds = $('input[name="vlcInstance"]:checked').map(function() {
      return $(this).val();
    }).get();

    // If no instances are selected, send empty string to control all instances
    if (instanceIds.length === 0) {
      instanceIds = [""];
    }

    req = $.get('/player/' + cmd, { instanceId: instanceIds.join(',') });
    req.success(function() {
      return console.log(cmd + " was called");
    });
    return req.error(function() {
      return console.error("could not run " + cmd);
    });
  };

  $(document).ready(function() {
    var req;

    $("#pause").click(function() {
      return runCmd('pause');
    });
    $("#stop").click(function() {
      return runCmd('stop');
    });
    $("#next").click(function() {
      return runCmd('next');
    });
    $("#prev").click(function() {
      return runCmd('prev');
    });
    req = $.getJSON('/clients/*');
    return req.success(function(clients) {
      var c, container, _i, _len, _results;

      container = $("#vlcInstances");
      _results = [];
      for (_i = 0, _len = clients.length; _i < _len; _i++) {
        c = clients[_i];
        var instanceId = c.host + ":" + c.port;
        container.append(
          "<div>" +
          "<input type='checkbox' name='vlcInstance' value='" + instanceId + "' id='vlc_" + _i + "'>" +
          "<label for='vlc_" + _i + "'>" + instanceId + "</label>" +
          "</div>"
        );
      }
      return _results;
    });
  });

}).call(this);
